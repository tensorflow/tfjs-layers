/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */

import * as tfc from '@tensorflow/tfjs-core';

import * as tfl from './index';
import {describeMathCPU} from './utils/test_utils';

describeMathCPU('OCR model test', () => {
  fit('execute model', async () => {
    const jsonObj = JSON.parse(modelJSONString);
    console.log(jsonObj);  // DEBUG
    const model = await tfl.models.modelFromJSON(jsonObj);
    // model.summary();  // DEBUG
    console.log(model.inputs.length);  // DEBUG
    for (const input of model.inputs) {
      console.log(input.shape);  // DEBUG
    }
    const xs = tfc.randomUniform([1, 32, 8, 1]);
    const ys = model.predict(xs) as tfc.Tensor;
    ys.print();
  });

  it('Diamond-shaped graph in functional model', () => {
    const input = tfl.input({shape: [2, 6]});
    const f1 =
        tfl.layers.flatten({name: 'f1'}).apply(input) as tfl.SymbolicTensor;
    const r1 =
        tfl.layers.reshape({targetShape: [2, 6], name: 'r1'}).apply(f1) as
        tfl.SymbolicTensor;
    const c1 = tfl.layers.concatenate({name: 'c1'}).apply([input, r1]) as
        tfl.SymbolicTensor;
    const model = tfl.model({inputs: [input], outputs: [c1]});
    model.summary();  // DEBUG
    const xs = tfc.ones([1, 2, 6]);
    const ys = model.predict(xs) as tfc.Tensor;
    ys.print();
  });
});

const modelJSONString =
    `{"modelTopology":{"keras_version":"2.2.2","model_config":{"class_name":"Model","config":{"layers":[{"class_name":"InputLayer","inbound_nodes":[],"config":{"dtype":"float32","batch_input_shape":[null,32,null,1],"name":"the_input","sparse":false},"name":"the_input"},{"class_name":"Conv2D","inbound_nodes":[[["the_input",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_55","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[2,2],"dilation_rate":[1,1],"kernel_regularizer":{"class_name":"L1L2","config":{"l2":0.00009999999747378752,"l1":0}},"filters":64,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":false,"activity_regularizer":null,"kernel_size":[5,5]},"name":"conv2d_55"},{"class_name":"BatchNormalization","inbound_nodes":[[["conv2d_55",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_55","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_55"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_55",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_55"},"name":"activation_55"},{"class_name":"Conv2D","inbound_nodes":[[["activation_55",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_56","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_56"},{"class_name":"Concatenate","inbound_nodes":[[["conv2d_55",0,0,{}],["conv2d_56",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_49","axis":-1},"name":"concatenate_49"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_49",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_56","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_56"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_56",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_56"},"name":"activation_56"},{"class_name":"Conv2D","inbound_nodes":[[["activation_56",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_57","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_57"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_49",0,0,{}],["conv2d_57",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_50","axis":-1},"name":"concatenate_50"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_50",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_57","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_57"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_57",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_57"},"name":"activation_57"},{"class_name":"Conv2D","inbound_nodes":[[["activation_57",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_58","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_58"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_50",0,0,{}],["conv2d_58",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_51","axis":-1},"name":"concatenate_51"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_51",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_58","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_58"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_58",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_58"},"name":"activation_58"},{"class_name":"Conv2D","inbound_nodes":[[["activation_58",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_59","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_59"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_51",0,0,{}],["conv2d_59",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_52","axis":-1},"name":"concatenate_52"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_52",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_59","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_59"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_59",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_59"},"name":"activation_59"},{"class_name":"Conv2D","inbound_nodes":[[["activation_59",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_60","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_60"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_52",0,0,{}],["conv2d_60",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_53","axis":-1},"name":"concatenate_53"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_53",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_60","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_60"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_60",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_60"},"name":"activation_60"},{"class_name":"Conv2D","inbound_nodes":[[["activation_60",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_61","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_61"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_53",0,0,{}],["conv2d_61",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_54","axis":-1},"name":"concatenate_54"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_54",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_61","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_61"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_61",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_61"},"name":"activation_61"},{"class_name":"Conv2D","inbound_nodes":[[["activation_61",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_62","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_62"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_54",0,0,{}],["conv2d_62",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_55","axis":-1},"name":"concatenate_55"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_55",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_62","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_62"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_62",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_62"},"name":"activation_62"},{"class_name":"Conv2D","inbound_nodes":[[["activation_62",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_63","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_63"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_55",0,0,{}],["conv2d_63",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_56","axis":-1},"name":"concatenate_56"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_56",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_63","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_63"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_63",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_63"},"name":"activation_63"},{"class_name":"Conv2D","inbound_nodes":[[["activation_63",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_64","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":{"class_name":"L1L2","config":{"l2":0.00009999999747378752,"l1":0}},"filters":128,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":false,"activity_regularizer":null,"kernel_size":[1,1]},"name":"conv2d_64"},{"class_name":"Dropout","inbound_nodes":[[["conv2d_64",0,0,{}]]],"config":{"rate":0.2,"noise_shape":null,"trainable":true,"seed":null,"name":"dropout_5"},"name":"dropout_5"},{"class_name":"AveragePooling2D","inbound_nodes":[[["dropout_5",0,0,{}]]],"config":{"name":"average_pooling2d_5","trainable":true,"data_format":"channels_last","pool_size":[2,2],"padding":"valid","strides":[2,2]},"name":"average_pooling2d_5"},{"class_name":"BatchNormalization","inbound_nodes":[[["average_pooling2d_5",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_64","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_64"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_64",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_64"},"name":"activation_64"},{"class_name":"Conv2D","inbound_nodes":[[["activation_64",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_65","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_65"},{"class_name":"Concatenate","inbound_nodes":[[["average_pooling2d_5",0,0,{}],["conv2d_65",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_57","axis":-1},"name":"concatenate_57"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_57",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_65","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_65"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_65",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_65"},"name":"activation_65"},{"class_name":"Conv2D","inbound_nodes":[[["activation_65",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_66","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_66"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_57",0,0,{}],["conv2d_66",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_58","axis":-1},"name":"concatenate_58"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_58",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_66","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_66"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_66",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_66"},"name":"activation_66"},{"class_name":"Conv2D","inbound_nodes":[[["activation_66",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_67","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_67"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_58",0,0,{}],["conv2d_67",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_59","axis":-1},"name":"concatenate_59"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_59",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_67","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_67"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_67",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_67"},"name":"activation_67"},{"class_name":"Conv2D","inbound_nodes":[[["activation_67",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_68","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_68"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_59",0,0,{}],["conv2d_68",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_60","axis":-1},"name":"concatenate_60"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_60",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_68","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_68"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_68",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_68"},"name":"activation_68"},{"class_name":"Conv2D","inbound_nodes":[[["activation_68",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_69","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_69"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_60",0,0,{}],["conv2d_69",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_61","axis":-1},"name":"concatenate_61"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_61",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_69","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_69"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_69",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_69"},"name":"activation_69"},{"class_name":"Conv2D","inbound_nodes":[[["activation_69",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_70","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_70"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_61",0,0,{}],["conv2d_70",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_62","axis":-1},"name":"concatenate_62"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_62",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_70","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_70"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_70",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_70"},"name":"activation_70"},{"class_name":"Conv2D","inbound_nodes":[[["activation_70",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_71","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_71"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_62",0,0,{}],["conv2d_71",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_63","axis":-1},"name":"concatenate_63"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_63",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_71","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_71"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_71",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_71"},"name":"activation_71"},{"class_name":"Conv2D","inbound_nodes":[[["activation_71",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_72","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_72"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_63",0,0,{}],["conv2d_72",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_64","axis":-1},"name":"concatenate_64"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_64",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_72","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_72"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_72",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_72"},"name":"activation_72"},{"class_name":"Conv2D","inbound_nodes":[[["activation_72",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_73","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":{"class_name":"L1L2","config":{"l2":0.00009999999747378752,"l1":0}},"filters":128,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":false,"activity_regularizer":null,"kernel_size":[1,1]},"name":"conv2d_73"},{"class_name":"Dropout","inbound_nodes":[[["conv2d_73",0,0,{}]]],"config":{"rate":0.2,"noise_shape":null,"trainable":true,"seed":null,"name":"dropout_6"},"name":"dropout_6"},{"class_name":"AveragePooling2D","inbound_nodes":[[["dropout_6",0,0,{}]]],"config":{"name":"average_pooling2d_6","trainable":true,"data_format":"channels_last","pool_size":[2,2],"padding":"valid","strides":[2,2]},"name":"average_pooling2d_6"},{"class_name":"BatchNormalization","inbound_nodes":[[["average_pooling2d_6",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_73","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_73"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_73",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_73"},"name":"activation_73"},{"class_name":"Conv2D","inbound_nodes":[[["activation_73",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_74","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_74"},{"class_name":"Concatenate","inbound_nodes":[[["average_pooling2d_6",0,0,{}],["conv2d_74",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_65","axis":-1},"name":"concatenate_65"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_65",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_74","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_74"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_74",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_74"},"name":"activation_74"},{"class_name":"Conv2D","inbound_nodes":[[["activation_74",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_75","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_75"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_65",0,0,{}],["conv2d_75",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_66","axis":-1},"name":"concatenate_66"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_66",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_75","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_75"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_75",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_75"},"name":"activation_75"},{"class_name":"Conv2D","inbound_nodes":[[["activation_75",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_76","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_76"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_66",0,0,{}],["conv2d_76",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_67","axis":-1},"name":"concatenate_67"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_67",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_76","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_76"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_76",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_76"},"name":"activation_76"},{"class_name":"Conv2D","inbound_nodes":[[["activation_76",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_77","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_77"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_67",0,0,{}],["conv2d_77",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_68","axis":-1},"name":"concatenate_68"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_68",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_77","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_77"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_77",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_77"},"name":"activation_77"},{"class_name":"Conv2D","inbound_nodes":[[["activation_77",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_78","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_78"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_68",0,0,{}],["conv2d_78",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_69","axis":-1},"name":"concatenate_69"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_69",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_78","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_78"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_78",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_78"},"name":"activation_78"},{"class_name":"Conv2D","inbound_nodes":[[["activation_78",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_79","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_79"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_69",0,0,{}],["conv2d_79",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_70","axis":-1},"name":"concatenate_70"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_70",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_79","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_79"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_79",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_79"},"name":"activation_79"},{"class_name":"Conv2D","inbound_nodes":[[["activation_79",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_80","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_80"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_70",0,0,{}],["conv2d_80",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_71","axis":-1},"name":"concatenate_71"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_71",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_80","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_80"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_80",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_80"},"name":"activation_80"},{"class_name":"Conv2D","inbound_nodes":[[["activation_80",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"normal","scale":2,"seed":null,"mode":"fan_in"}},"name":"conv2d_81","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"linear","trainable":true,"data_format":"channels_last","padding":"same","strides":[1,1],"dilation_rate":[1,1],"kernel_regularizer":null,"filters":8,"bias_initializer":{"class_name":"Zeros","config":{}},"use_bias":true,"activity_regularizer":null,"kernel_size":[3,3]},"name":"conv2d_81"},{"class_name":"Concatenate","inbound_nodes":[[["concatenate_71",0,0,{}],["conv2d_81",0,0,{}]]],"config":{"trainable":true,"name":"concatenate_72","axis":-1},"name":"concatenate_72"},{"class_name":"BatchNormalization","inbound_nodes":[[["concatenate_72",0,0,{}]]],"config":{"gamma_initializer":{"class_name":"Ones","config":{}},"moving_mean_initializer":{"class_name":"Zeros","config":{}},"name":"batch_normalization_81","epsilon":0.000011,"trainable":true,"center":true,"moving_variance_initializer":{"class_name":"Ones","config":{}},"beta_initializer":{"class_name":"Zeros","config":{}},"scale":true,"gamma_regularizer":null,"gamma_constraint":null,"beta_constraint":null,"beta_regularizer":null,"momentum":0.99,"axis":-1},"name":"batch_normalization_81"},{"class_name":"Activation","inbound_nodes":[[["batch_normalization_81",0,0,{}]]],"config":{"activation":"relu","trainable":true,"name":"activation_81"},"name":"activation_81"},{"class_name":"Permute","inbound_nodes":[[["activation_81",0,0,{}]]],"config":{"dims":[2,1,3],"trainable":true,"name":"permute"},"name":"permute"},{"class_name":"TimeDistributed","inbound_nodes":[[["permute",0,0,{}]]],"config":{"layer":{"class_name":"Flatten","config":{"trainable":true,"name":"flatten_3","data_format":"channels_last"}},"trainable":true,"name":"flatten"},"name":"flatten"},{"class_name":"Dense","inbound_nodes":[[["flatten",0,0,{}]]],"config":{"kernel_initializer":{"class_name":"VarianceScaling","config":{"distribution":"uniform","scale":1,"seed":null,"mode":"fan_avg"}},"name":"out","kernel_constraint":null,"bias_regularizer":null,"bias_constraint":null,"activation":"softmax","trainable":true,"kernel_regularizer":null,"bias_initializer":{"class_name":"Zeros","config":{}},"units":5990,"use_bias":true,"activity_regularizer":null},"name":"out"}],"input_layers":[["the_input",0,0]],"name":"model_1","output_layers":[["out",0,0]]}},"backend":"tensorflow"}}`;
